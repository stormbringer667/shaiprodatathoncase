[SERVICE]
    Flush         5
    Daemon        Off
    Log_Level     info
    Parsers_File  parsers.conf
    HTTP_Server   On
    HTTP_Listen   0.0.0.0
    HTTP_Port     2020

[INPUT]
    Name              tail
    Path              /opt/cowrie/var/log/cowrie/cowrie.json
    Tag               honeypot.cowrie
    Parser            json
    Refresh_Interval  5

[INPUT]
    Name              tail
    Path              /opt/dionaea/var/log/dionaea/*.log
    Tag               honeypot.dionaea
    Parser            json
    Refresh_Interval  5

[INPUT]
    Name              systemd
    Tag               system.auth
    Systemd_Filter    _SYSTEMD_UNIT=ssh.service

[INPUT]
    Name              tail
    Path              /var/log/auth.log
    Tag               system.auth
    Parser            syslog

[INPUT]
    Name              syslog
    Mode              tcp
    Listen            0.0.0.0
    Port              5140
    Parser            paloalto_syslog
    Tag               firewall.paloalto

[FILTER]
    Name              modify
    Match             honeypot.*
    Add               source_type honeypot
    Add               data_classification security

[FILTER]
    Name              modify
    Match             firewall.*
    Add               source_type firewall
    Add               data_classification security

# Optional GeoIP (requires plugin/build)
# [FILTER]
#     Name              geoip
#     Match             *
#     Lookup_Key        src_ip
#     Database          /var/lib/GeoIP/GeoLite2-City.mmdb

[OUTPUT]
    Name              kafka
    Match             honeypot.cowrie
    Brokers           localhost:9092
    Topics            honeypot-cowrie
    rdkafka.client.id fluent-bit-cowrie

[OUTPUT]
    Name              kafka
    Match             honeypot.dionaea
    Brokers           localhost:9092
    Topics            honeypot-dionaea
    rdkafka.client.id fluent-bit-dionaea

[OUTPUT]
    Name              kafka
    Match             firewall.paloalto
    Brokers           localhost:9092
    Topics            firewall-paloalto
    rdkafka.client.id fluent-bit-paloalto

[OUTPUT]
    Name              file
    Match             *
    Path              /var/log/fluent-bit
    File              security-events.log
